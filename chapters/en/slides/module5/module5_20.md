---
type: slides
---

# Annotating with text and color

Notes: In this module we will be learning how to use color and text to
annotate our visualizations and highlight important features.

---

## Understanding the periodic variations in the Wikipedia donations

``` python
# TODO save wrangled data?
import pandas as pd
import altair as alt
from vega_datasets import data

donations = (
    pd.read_csv("https://frdata.wikimedia.org/donationdata-vs-day.csv", parse_dates=['date'])
    .query('2020 < date < 2021')
    .assign(week_day=lambda df: df['date'].dt.day_name().str[:3]))

alt.Chart(donations, title='Wikipedia donations peak during Christmas').mark_line().encode(
    alt.X('date', title=None),
    alt.Y('sum', axis=alt.Axis(format='$s'), title='Amount donated per day'))
```

<?xml version="1.0" encoding="utf-8"?>


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="485" height="349" viewBox="0 0 485 349"><rect width="485" height="349" fill="white"/><g fill="none" stroke-miterlimit="10" transform="translate(67,27)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0.5,0.5h400v300h-400Z" stroke="#ddd"/><g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,300.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(33,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(65,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(99,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(132,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(166,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(199,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(233,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(267,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(300,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(334,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(367,-300)" x2="0" y2="300" stroke="#ddd" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(0,300)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,270)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,240)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,210)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,180)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,150)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,120)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,60)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(0,0)" x2="400" y2="0" stroke="#ddd" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="X-axis for a time scale with values from Thursday, 02 January 2020, 12:00:00 AM to Thursday, 31 December 2020, 12:00:00 AM"><g transform="translate(0.5,300.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(33,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(65,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(99,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(132,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(166,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(199,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(233,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(267,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(300,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(334,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(367,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="middle" transform="translate(32.967032967032964,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">February</text><text text-anchor="middle" transform="translate(64.83516483516483,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="0">March</text><text text-anchor="middle" transform="translate(98.85531135531136,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">April</text><text text-anchor="middle" transform="translate(131.82234432234432,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="0">May</text><text text-anchor="middle" transform="translate(165.8882783882784,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">June</text><text text-anchor="middle" transform="translate(198.85531135531136,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="0">July</text><text text-anchor="middle" transform="translate(232.92124542124543,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">August</text><text text-anchor="middle" transform="translate(266.98717948717945,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="0">September</text><text text-anchor="middle" transform="translate(299.95421245421244,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">October</text><text text-anchor="middle" transform="translate(334.0201465201465,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="0">November</text><text text-anchor="middle" transform="translate(367.032967032967,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">December</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="400" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis titled 'Amount donated per day' for a linear scale with values from $0M to $5M"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,300)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,270)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,240)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,210)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,180)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,150)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,120)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,60)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,0)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,303)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$0.0M</text><text text-anchor="end" transform="translate(-7,273)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$0.5M</text><text text-anchor="end" transform="translate(-7,243)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$1.0M</text><text text-anchor="end" transform="translate(-7,213)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$1.5M</text><text text-anchor="end" transform="translate(-7,183)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$2.0M</text><text text-anchor="end" transform="translate(-7,153)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$2.5M</text><text text-anchor="end" transform="translate(-7,123)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$3.0M</text><text text-anchor="end" transform="translate(-7,93.00000000000001)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$3.5M</text><text text-anchor="end" transform="translate(-7,62.999999999999986)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$4.0M</text><text text-anchor="end" transform="translate(-7,32.99999999999999)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$4.5M</text><text text-anchor="end" transform="translate(-7,3)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$5.0M</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,300)" x2="0" y2="-300" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(-51,150) rotate(-90) translate(0,-2)" font-family="sans-serif" font-size="11px" font-weight="bold" fill="#000" opacity="1">Amount
donated per
day</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-line role-mark marks" role="graphics-object" aria-roledescription="line mark container"><path aria-label="date: Jan 02, 2020; Amount donated per day: $62.4198k" role="graphics-symbol" aria-roledescription="line mark" d="M0,296.2548126L1.098901098901099,297.7209798L2.197802197802198,298.426854L3.296703296703297,297.9686358L4.395604395604396,298.4131734L5.4945054945054945,298.6456374L6.593406593406594,298.868457L7.6923076923076925,299.2039794L8.791208791208792,299.298567L9.89010989010989,299.2260852L10.989010989010989,299.05834200000004L12.087912087912088,299.3157102L13.186813186813188,298.9185246L14.285714285714285,299.1917088L15.384615384615385,299.2528776L16.483516483516482,299.4387252L17.582417582417584,299.2929456L18.681318681318682,299.2625076L19.78021978021978,299.3906412L20.87912087912088,299.40282840000003L21.978021978021978,254.4400752L23.076923076923077,299.4505914L24.175824175824175,299.5118346L25.274725274725274,299.2502058L26.373626373626376,299.6602074L27.472527472527474,299.1354966L28.57142857142857,298.9837476L29.67032967032967,299.4424488L30.76923076923077,299.520783L31.868131868131865,299.0170554L32.967032967032964,299.606532L34.065934065934066,299.6001798L35.16483516483517,299.5451598L36.26373626373626,287.35698179999997L37.362637362637365,297.0820926L38.46153846153847,278.584317L39.56043956043956,295.23722399999997L40.65934065934066,297.9418806L41.75824175824176,298.29079859999996L42.857142857142854,298.394778L43.956043956043956,286.3985814L45.05494505494506,288.96556319999996L46.15384615384615,286.9117656L47.25274725274725,297.3535326L48.35164835164835,298.6559376L49.45054945054945,298.8364434L50.54945054945055,298.9576386L51.64835164835166,299.2230036L52.74725274725275,280.70489280000004L53.84615384615385,293.6892048L54.94505494505495,298.2946074L56.043956043956044,299.0276784L57.14285714285714,299.1136608L58.24175824175825,299.07096540000003L59.34065934065934,299.2559526L60.43956043956044,299.2499724L61.53846153846154,288.7036098L62.637362637362635,286.6399032L63.73626373626373,298.737978L64.83516483516483,298.8037854L65.93406593406593,298.9751202L67.03296703296702,290.932368L68.13186813186813,281.193948L69.23076923076923,280.3036992L70.32967032967034,290.527401L71.42857142857143,291.28563959999997L72.52747252747253,292.5403386L73.58058608058609,294.0034452L74.67948717948718,294.167742L75.77838827838828,284.9947128L76.87728937728939,282.427545L77.97619047619048,298.5282438L79.07509157509158,298.8762468L80.17399267399267,299.0169372L81.27289377289377,299.4837582L82.37179487179486,299.4278346L83.47069597069597,299.59182119999997L84.56959706959707,299.481573L85.66849816849816,299.4251634L86.76739926739927,299.5876032L87.86630036630036,299.4889686L88.96520146520146,299.620785L90.06410256410257,299.6838978L91.16300366300366,299.590464L92.26190476190477,299.680221L93.36080586080587,298.1588292L94.45970695970696,299.67898379999997L95.55860805860806,299.4990198L96.65750915750915,296.45786400000003L97.75641025641025,298.5505788L98.85531135531136,295.6772886L99.95421245421245,296.4877362L101.05311355311355,297.3322476L102.15201465201464,297.469557L103.25091575091577,297.544353L104.34981684981686,297.78144119999996L105.44871794871796,289.8071196L106.54761904761905,295.2889998L107.64652014652015,294.1330686L108.74542124542124,294.698667L109.84432234432235,295.46793660000003L110.94322344322345,295.758519L112.04212454212454,295.9803816L113.14102564102564,291.2463306L114.23992673992673,272.382645L115.33882783882783,296.7443262L116.43772893772895,297.0471102L117.53663003663004,297.0066276L118.63553113553114,297.1307844L119.73443223443223,297.3643452L120.83333333333333,294.3082998L121.93223443223444,297.172818L123.03113553113553,278.142333L124.13003663003663,293.385603L125.22893772893772,296.207307L126.32783882783882,296.592579L127.42673992673991,285.4626954L128.52564102564102,296.7210864L129.62454212454213,297.4646766L130.7234432234432,283.6465242L131.82234432234432,295.8501582L132.9212454212454,297.7388088L134.0201465201465,298.1559168L135.11904761904762,298.3118442L136.21794871794873,297.9821256L137.3168498168498,281.858583L138.41575091575092,280.1565648L139.514652014652,296.6828148L140.6135531135531,297.9998418L141.71245421245422,297.903126L142.81135531135533,298.2123126L143.9102564102564,298.0639818L145.00915750915752,292.3682682L146.1080586080586,297.2908164L147.2069597069597,297.828921L148.30586080586082,297.7175484L149.4047619047619,298.182948L150.503663003663,298.2021822L151.6025641025641,298.0608888L152.7014652014652,293.7230826L153.8003663003663,297.6170208L154.89926739926742,297.8502204L155.9981684981685,298.1408688L157.0970695970696,298.221909L158.1959706959707,299.6588082L159.2948717948718,299.9817054L160.3937728937729,299.9961858L161.49267399267399,299.8849434L162.5915750915751,298.0745742L163.69047619047618,298.2286656L164.78937728937728,298.059027L165.8882783882784,296.0705652L166.9871794871795,298.3025022L168.08608058608058,286.718793L169.1849816849817,283.71129840000003L170.28388278388277,299.1914718L171.38278388278388,299.505933L172.481684981685,299.6376834L173.58058608058607,299.6119086L174.67948717948718,298.41204300000004L175.77838827838826,299.3930406L176.87728937728937,299.558646L177.97619047619045,299.6726268L179.0750915750916,299.44490160000004L180.17399267399267,299.4437574L181.27289377289378,299.2531524L182.37179487179486,289.9239762L183.47069597069597,297.847179L184.56959706959708,295.3438488L185.66849816849816,299.254314L186.76739926739927,299.4663882L187.86630036630038,299.446716L188.96520146520146,299.3827998L190.06410256410254,290.37438119999996L191.16300366300368,298.1482692L192.26190476190476,298.8217182L193.36080586080587,299.02389239999997L194.45970695970695,299.4980004L195.55860805860806,299.3868498L196.65750915750914,299.39634L197.75641025641028,297.4539696L198.85531135531136,298.2645714L199.95421245421247,298.1939532L201.05311355311355,299.46328020000004L202.15201465201466,299.67207L203.25091575091574,299.5350768L204.34981684981685,299.4146418L205.44871794871793,292.0514202L206.54761904761907,222.76427460000002L207.64652014652017,287.117364L208.74542124542126,289.52758919999997L209.84432234432236,290.326758L210.94322344322345,291.8544612L212.04212454212455,292.2574518L213.14102564102564,292.7566848L214.23992673992674,235.0138998L215.33882783882783,294.1542504L216.43772893772893,294.215415L217.53663003663002,295.54451339999997L218.63553113553112,295.1066766L219.73443223443226,295.536741L220.83333333333334,292.3166754L221.93223443223445,234.1699176L223.03113553113553,292.32909359999996L224.13003663003664,295.5986484L225.22893772893772,295.560984L226.32783882783883,295.3941246L227.4267399267399,296.0751258L228.52564102564102,253.1012382L229.6245421245421,220.47956939999997L230.7234432234432,279.3182256L231.82234432234435,283.3595682L232.92124542124543,284.9100012L234.02014652014654,286.944441L235.11904761904762,288.8895828L236.21794871794873,288.8504778L237.3168498168498,231.9779328L238.41575091575092,274.3415358L239.514652014652,290.0573082L240.6135531135531,291.2916462L241.7124542124542,292.5080256L242.8113553113553,295.84578419999997L243.91025641025644,293.9040342L245.00915750915752,224.44334099999998L246.10805860805863,278.6220498L247.2069597069597,291.15558599999997L248.30586080586082,291.8638404L249.4047619047619,292.5023502L250.503663003663,293.8202592L251.6025641025641,276.3374202L252.7014652014652,290.2269822L253.80036630036628,229.92045600000003L254.8992673992674,293.9524158L255.99816849816847,294.5501112L257.0970695970696,293.91385379999997L258.1959706959707,296.0975166L259.2948717948718,269.6675196L260.3937728937729,228.26343359999998L261.492673992674,290.9518476L262.59157509157507,293.109948L263.6904761904762,294.4480164L264.7893772893773,294.6734808L265.88827838827837,286.4569854L266.98717948717945,292.94401980000004L268.0860805860806,196.3136868L269.1849816849817,273.6929142L270.2838827838828,284.0066688L271.3827838827839,285.57113580000004L272.48168498168496,287.879148L273.5805860805861,275.7081438L274.6794871794872,289.1083446L275.77838827838826,271.0975896L276.87728937728934,231.5392746L277.9761904761905,291.8585244L279.07509157509156,291.6396036L280.17399267399264,291.8660388L281.2728937728938,268.8257148L282.3717948717949,260.2600572L283.470695970696,221.7347106L284.5695970695971,252.9704346L285.66849816849816,281.5950234L286.76739926739924,285.1268172L287.8663003663004,291.4371078L288.96520146520146,255.6377382L290.06410256410254,258.3914436L291.1630036630037,196.81301100000002L292.26190476190476,255.5719872L293.36080586080584,284.141148L294.459706959707,289.55511540000003L295.55860805860806,291.34428959999997L296.6575091575092,267.6292596L297.7564102564103,254.3696208L298.85531135531136,233.3794668L299.95421245421244,248.1420942L301.0531135531136,267.2445378L302.15201465201466,277.82473680000004L303.25091575091574,280.12498980000004L304.3498168498168,242.4213492L305.44871794871796,251.982822L306.5476190476191,250.69617599999998L307.6465201465202,235.5705018L308.74542124542126,233.782218L309.84432234432234,286.188099L310.9432234432235,287.3505306L312.04212454212455,265.1039262L313.14102564102564,271.5087972L314.2399267399267,276.7432236L315.33882783882785,268.9552056L316.43772893772893,249.8805738L317.53663003663,291.3350532L318.6355311355311,289.2921978L319.73443223443223,273.8683428L320.83333333333337,284.5290672L321.93223443223445,250.97705820000002L323.03113553113553,245.7313986L324.1300366300366,285.2605194L325.22893772893775,291.6105318L326.32783882783883,292.46351699999997L327.4267399267399,256.1995854L328.525641025641,256.044081L329.62454212454213,255.19117500000002L330.7234432234432,276.59437080000004L331.82234432234435,292.3112412L332.92124542124543,242.35193280000001L334.0201465201465,295.1047368L335.16483516483515,280.5528276L336.2637362637363,266.9566752L337.3626373626374,255.91823639999998L338.46153846153845,271.4815368L339.56043956043953,290.7351708L340.65934065934067,294.81922560000004L341.75824175824175,296.07390480000004L342.85714285714283,275.2487892L343.95604395604397,275.1845046L345.05494505494505,248.2122252L346.1538461538462,255.92089620000002L347.25274725274727,286.4253312L348.35164835164835,235.019775L349.45054945054943,294.7163076L350.54945054945057,296.3242146L351.64835164835165,283.736103L352.74725274725273,256.4338674L353.8461538461538,234.89206140000002L354.94505494505495,243.87801660000002L356.04395604395603,237.5100348L357.14285714285717,292.0954554L358.24175824175825,280.1438358L359.34065934065933,267.0287814L360.43956043956047,265.701054L361.53846153846155,270.00116460000004L362.6373626373626,288.7923666L363.7362637362637,293.724879L364.83516483516485,294.1133568L365.9340659340659,170.4378714L367.032967032967,20.72678339999999L368.1318681318681,73.42777320000002L369.2307692307692,115.54463580000001L370.32967032967036,136.1210838L371.42857142857144,131.38156980000002L372.5274725274725,147.39286080000002L373.6263736263736,156.3830436L374.72527472527474,191.6289348L375.8241758241758,208.4892036L376.9230769230769,223.65640259999998L378.021978021978,228.15108360000002L379.1208791208791,225.2543466L380.2197802197802,220.92243059999998L381.31868131868134,233.91264959999998L382.4175824175824,239.313762L383.5164835164835,239.1749448L384.61538461538464,237.109791L385.7142857142857,237.8563884L386.8131868131868,232.4184042L387.9120879120879,232.2618012L389.010989010989,253.1559456L390.1098901098901,292.4236806L391.2087912087912,293.6186112L392.30769230769226,268.89094020000005L393.4065934065934,295.23117840000003L394.50549450549454,293.3224818L395.6043956043956,293.2261788L396.7032967032967,256.2118476L397.80219780219784,212.6263122L398.9010989010989,181.554375L400,172.8502608" stroke="#4c78a8" stroke-width="2"/></g><g class="mark-group role-title"><g transform="translate(200,-22)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-text role-title-text" role="graphics-symbol" aria-roledescription="title" aria-label="Title text 'Wikipedia donations peak during Christmas'" pointer-events="none"><text text-anchor="middle" transform="translate(0,10)" font-family="sans-serif" font-size="13px" font-weight="bold" fill="#000" opacity="1">Wikipedia
donations peak during
Christmas</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g></g><path class="foreground" aria-hidden="true" d="" display="none"/></g></g></g></svg>

Notes: Recall this plot of Wikipedia donations from a previous slide
deck in this module. We noted that the oscillating pattern might
indicate a dependency on a periodic date feature, such as weekday or day
of the month.

---

## Most contributions are donated in the middle of the week

``` python
from calendar import day_abbr


alt.Chart(donations).mark_bar().encode(
    alt.Y('week_day', sort=list(day_abbr), title=None),
    alt.X('sum(sum)', axis=alt.Axis(format='$s'), title='Total donated amount'))
```

<?xml version="1.0" encoding="utf-8"?>


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="442" height="182" viewBox="0 0 442 182"><rect width="442" height="182" fill="white"/><g fill="none" stroke-miterlimit="10" transform="translate(36,5)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0.5,0.5h400v140h-400Z" stroke="#ddd"/><g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="X-axis titled 'Total donated amount' for a linear scale with values from $0M to $35M"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="start" transform="translate(0,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$0M</text><text text-anchor="middle" transform="translate(57.14285714285714,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$5M</text><text text-anchor="middle" transform="translate(114.28571428571428,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$10M</text><text text-anchor="middle" transform="translate(171.42857142857142,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$15M</text><text text-anchor="middle" transform="translate(228.57142857142856,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$20M</text><text text-anchor="middle" transform="translate(285.7142857142857,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$25M</text><text text-anchor="middle" transform="translate(342.85714285714283,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$30M</text><text text-anchor="end" transform="translate(400,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$35M</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="400" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(200,30)" font-family="sans-serif" font-size="11px" font-weight="bold" fill="#000" opacity="1">Total
donated
amount</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis for a discrete scale with 7 values: Mon, Tue, Wed, Thu, Fri, Sat, Sun"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,10)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,50)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,70)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,110)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,130)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,12.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Mon</text><text text-anchor="end" transform="translate(-7,32.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Tue</text><text text-anchor="end" transform="translate(-7,52.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Wed</text><text text-anchor="end" transform="translate(-7,72.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Thu</text><text text-anchor="end" transform="translate(-7,92.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Fri</text><text text-anchor="end" transform="translate(-7,112.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sat</text><text text-anchor="end" transform="translate(-7,132.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sun</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="140" stroke="#888" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-rect role-mark marks" role="graphics-object" aria-roledescription="rect mark container"><path aria-label="Total donated amount: $23.8489M; week_day: Thu" role="graphics-symbol" aria-roledescription="bar" d="M0,61h272.55838639999996v18h-272.55838639999996Z" fill="#4c78a8"/><path aria-label="Total donated amount: $12.7874M; week_day: Fri" role="graphics-symbol" aria-roledescription="bar" d="M0,81h146.14180548571426v18h-146.14180548571426Z" fill="#4c78a8"/><path aria-label="Total donated amount: $12.0615M; week_day: Sat" role="graphics-symbol" aria-roledescription="bar" d="M0,101h137.84597359999998v18h-137.84597359999998Z" fill="#4c78a8"/><path aria-label="Total donated amount: $8.72164M; week_day: Sun" role="graphics-symbol" aria-roledescription="bar" d="M0,121h99.6759358857143v18h-99.6759358857143Z" fill="#4c78a8"/><path aria-label="Total donated amount: $15.0398M; week_day: Mon" role="graphics-symbol" aria-roledescription="bar" d="M0,1h171.88333599999999v18h-171.88333599999999Z" fill="#4c78a8"/><path aria-label="Total donated amount: $19.6777M; week_day: Tue" role="graphics-symbol" aria-roledescription="bar" d="M0,21h224.8885048v18h-224.8885048Z" fill="#4c78a8"/><path aria-label="Total donated amount: $32.4594M; week_day: Wed" role="graphics-symbol" aria-roledescription="bar" d="M0,41h370.9645148571429v18h-370.9645148571429Z" fill="#4c78a8"/></g></g><path class="foreground" aria-hidden="true" d="" display="none"/></g></g></g></svg>

Notes: Here we are using the built-in calendar module to get a sorted
list of the weekday abbreviations, but we could also have written it out
by hand.

We can see that most contributions seem to be donated in the middle of
the week and the Wed stands out as the day where the highest amount of
money is donated.

To draw additional attention to this bar, we could use color to
highlight it.

---

## Color can be used to highlight specific features of a visualization

``` python
alt.Chart(donations).mark_bar().encode(
    alt.Y('week_day', sort=list(day_abbr), title=None),
    alt.X('sum(sum)', axis=alt.Axis(format='$s'), title='Total donated amount'),
    color = alt.condition(alt.datum.week_day == 'Wed',
                          alt.value('coral'),
                          alt.value('steelblue')))
```

<?xml version="1.0" encoding="utf-8"?>


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="442" height="182" viewBox="0 0 442 182"><rect width="442" height="182" fill="white"/><g fill="none" stroke-miterlimit="10" transform="translate(36,5)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0.5,0.5h400v140h-400Z" stroke="#ddd"/><g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="X-axis titled 'Total donated amount' for a linear scale with values from $0M to $35M"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="start" transform="translate(0,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$0M</text><text text-anchor="middle" transform="translate(57.14285714285714,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$5M</text><text text-anchor="middle" transform="translate(114.28571428571428,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$10M</text><text text-anchor="middle" transform="translate(171.42857142857142,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$15M</text><text text-anchor="middle" transform="translate(228.57142857142856,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$20M</text><text text-anchor="middle" transform="translate(285.7142857142857,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$25M</text><text text-anchor="middle" transform="translate(342.85714285714283,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$30M</text><text text-anchor="end" transform="translate(400,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$35M</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="400" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(200,30)" font-family="sans-serif" font-size="11px" font-weight="bold" fill="#000" opacity="1">Total
donated
amount</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis for a discrete scale with 7 values: Mon, Tue, Wed, Thu, Fri, Sat, Sun"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,10)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,50)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,70)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,110)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,130)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,12.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Mon</text><text text-anchor="end" transform="translate(-7,32.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Tue</text><text text-anchor="end" transform="translate(-7,52.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Wed</text><text text-anchor="end" transform="translate(-7,72.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Thu</text><text text-anchor="end" transform="translate(-7,92.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Fri</text><text text-anchor="end" transform="translate(-7,112.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sat</text><text text-anchor="end" transform="translate(-7,132.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sun</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="140" stroke="#888" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-rect role-mark marks" role="graphics-object" aria-roledescription="rect mark container"><path aria-label="Total donated amount: $23.8489M; week_day: Thu" role="graphics-symbol" aria-roledescription="bar" d="M0,61h272.55838639999996v18h-272.55838639999996Z" fill="steelblue"/><path aria-label="Total donated amount: $12.7874M; week_day: Fri" role="graphics-symbol" aria-roledescription="bar" d="M0,81h146.14180548571426v18h-146.14180548571426Z" fill="steelblue"/><path aria-label="Total donated amount: $12.0615M; week_day: Sat" role="graphics-symbol" aria-roledescription="bar" d="M0,101h137.84597359999998v18h-137.84597359999998Z" fill="steelblue"/><path aria-label="Total donated amount: $8.72164M; week_day: Sun" role="graphics-symbol" aria-roledescription="bar" d="M0,121h99.6759358857143v18h-99.6759358857143Z" fill="steelblue"/><path aria-label="Total donated amount: $15.0398M; week_day: Mon" role="graphics-symbol" aria-roledescription="bar" d="M0,1h171.88333599999999v18h-171.88333599999999Z" fill="steelblue"/><path aria-label="Total donated amount: $19.6777M; week_day: Tue" role="graphics-symbol" aria-roledescription="bar" d="M0,21h224.8885048v18h-224.8885048Z" fill="steelblue"/><path aria-label="Total donated amount: $32.4594M; week_day: Wed" role="graphics-symbol" aria-roledescription="bar" d="M0,41h370.9645148571429v18h-370.9645148571429Z" fill="coral"/></g></g><path class="foreground" aria-hidden="true" d="" display="none"/></g></g></g></svg>

Notes: To add a highlight color, we could create a new column in our
dataframe that has a unique value for the bars we want to highlight and
the same value for everything else.

Then we could use this as a categorical column to color by via the
`color` encoding.

The downside of this is that we need to modify the dataframe, which
might not always be desired. It is also clunky when we are computing an
aggregation in Altair, such as using this `sum` here, and we would need
to recompute this in pandas.

Because of these inconveniences, it is often preferred to use the
built-in Altair approach for highlighting by passing a conditional
encoding to the `color` parameter of the chart as we do in this slide.

Conceptually, you can think of `alt.condition` like this:
`alt.condition(IF this is true, DO this, ELSE DO this)`.

So here we are checking if the `week_day` column has the value `'Wed'`,
and if it does we use the `'coral'` color, otherwise we use the default
`'steelblue'` color.

We need to `alt.value` to tell Altair that we want to use this specific
color name, rather than looking for a column in the dataframe with this
name.

`alt.datum` is a way to unambiguously access a column name in
conditional statements and other Altair computations, so that it is not
confused for just that string of letters.

---

## Text labels can be added with custom annotations

``` python
chart = alt.Chart(donations).mark_bar().encode(
    alt.Y('week_day', sort=list(day_abbr), title=None),
    alt.X('sum(sum)', axis=alt.Axis(format='$s'), title='Total donated amount'),
    color = alt.condition(alt.datum.week_day == 'Wed',
                          alt.value('coral'),
                          alt.value('steelblue')))
(chart 
 + chart
 .mark_text(align='left', dx=-125, dy=-15)
 .encode(text=alt.condition(alt.datum.week_day == 'Wed', alt.value('Salaries are paid on Wed'), alt.value(''))))
```

<?xml version="1.0" encoding="utf-8"?>


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="498" height="193" viewBox="0 0 498 193"><rect width="498" height="193" fill="white"/><g fill="none" stroke-miterlimit="10" transform="translate(36,16)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0.5,0.5h400v140h-400Z" stroke="#ddd"/><g><g class="mark-group role-axis" aria-hidden="true"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-grid" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="-140" stroke="#ddd" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="X-axis titled 'Total donated amount' for a linear scale with values from $0M to $35M"><g transform="translate(0.5,140.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(57,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(114,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(171,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(229,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(286,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(343,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(400,0)" x2="0" y2="5" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="start" transform="translate(0,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$0M</text><text text-anchor="middle" transform="translate(57.14285714285714,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$5M</text><text text-anchor="middle" transform="translate(114.28571428571428,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$10M</text><text text-anchor="middle" transform="translate(171.42857142857142,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$15M</text><text text-anchor="middle" transform="translate(228.57142857142856,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$20M</text><text text-anchor="middle" transform="translate(285.7142857142857,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$25M</text><text text-anchor="middle" transform="translate(342.85714285714283,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$30M</text><text text-anchor="end" transform="translate(400,15)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">$35M</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="400" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-title" pointer-events="none"><text text-anchor="middle" transform="translate(200,30)" font-family="sans-serif" font-size="11px" font-weight="bold" fill="#000" opacity="1">Total
donated
amount</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis for a discrete scale with 7 values: Mon, Tue, Wed, Thu, Fri, Sat, Sun"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,10)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,50)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,70)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,110)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,130)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,12.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Mon</text><text text-anchor="end" transform="translate(-7,32.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Tue</text><text text-anchor="end" transform="translate(-7,52.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Wed</text><text text-anchor="end" transform="translate(-7,72.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Thu</text><text text-anchor="end" transform="translate(-7,92.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Fri</text><text text-anchor="end" transform="translate(-7,112.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sat</text><text text-anchor="end" transform="translate(-7,132.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sun</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="140" stroke="#888" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-rect role-mark layer_0_marks" role="graphics-object" aria-roledescription="rect mark container"><path aria-label="Total donated amount: $23.8489M; week_day: Thu" role="graphics-symbol" aria-roledescription="bar" d="M0,61h272.55838639999996v18h-272.55838639999996Z" fill="steelblue"/><path aria-label="Total donated amount: $12.7874M; week_day: Fri" role="graphics-symbol" aria-roledescription="bar" d="M0,81h146.14180548571426v18h-146.14180548571426Z" fill="steelblue"/><path aria-label="Total donated amount: $12.0615M; week_day: Sat" role="graphics-symbol" aria-roledescription="bar" d="M0,101h137.84597359999998v18h-137.84597359999998Z" fill="steelblue"/><path aria-label="Total donated amount: $8.72164M; week_day: Sun" role="graphics-symbol" aria-roledescription="bar" d="M0,121h99.6759358857143v18h-99.6759358857143Z" fill="steelblue"/><path aria-label="Total donated amount: $15.0398M; week_day: Mon" role="graphics-symbol" aria-roledescription="bar" d="M0,1h171.88333599999999v18h-171.88333599999999Z" fill="steelblue"/><path aria-label="Total donated amount: $19.6777M; week_day: Tue" role="graphics-symbol" aria-roledescription="bar" d="M0,21h224.8885048v18h-224.8885048Z" fill="steelblue"/><path aria-label="Total donated amount: $32.4594M; week_day: Wed" role="graphics-symbol" aria-roledescription="bar" d="M0,41h370.9645148571429v18h-370.9645148571429Z" fill="coral"/></g><g class="mark-text role-mark layer_1_marks" role="graphics-object" aria-roledescription="text mark container"><text aria-label="Total donated amount: $23.8489M; week_day: Thu" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(147.55838639999996,58)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $12.7874M; week_day: Fri" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(21.141805485714258,78)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $12.0615M; week_day: Sat" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(12.84597359999998,98)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $8.72164M; week_day: Sun" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(-25.324064114285704,118)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $15.0398M; week_day: Mon" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(46.883335999999986,-2)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $19.6777M; week_day: Tue" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(99.88850479999999,18)" font-family="sans-serif" font-size="11px" fill="steelblue"/><text aria-label="Total donated amount: $32.4594M; week_day: Wed" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(245.9645148571429,38)" font-family="sans-serif" font-size="11px" fill="coral">Salaries
are paid on
Wed</text></g></g><path class="foreground" aria-hidden="true" d="" display="none"/></g></g></g></svg>

Notes: We can add a custom text annotation to the plot in the same way
that we added a custom color. This could be an explanatory label, for
example when an event happened on a time axis, or as the label that we
made up for this chart.

We use `dx` and `dy` to position the label relative the top of the bar.

---

## Text labels of the values can be added to each bar to facilitate reading the exact value

``` python
chart + chart.mark_text(align='left').encode(text='sum(sum)')
```

Notes: As we saw in a previous slide deck, it is possible to add text
annotations directly on the plots.

This is beneficial when we want to communicate the exact value to our
audience, and can give the plot a different look and feel.

The default formatting is not very easy to read, so lets use what we
learned previously to reformat the label and make this chart more
effective.

---

## Text marks can be formatted in the same manner as axes labels

``` python
chart + chart.mark_text(align='left', dx=2).encode(text=alt.Text('sum(sum)', format='$,d'))
```

Notes: `alt.Text` uses the `format` parameter directly instead of within
`alt.Axis`. Here we add a thousands separator (`,`) and round the values
to integers (`d`) to remove the decimals.

We also use `dx` to indtroduce some whitespace between the bar and the
label.

This makes the labels easier to read, but since we have thousands of
thousands, we could simplify further by using the millions suffix.

---

## Standard international units can shorten labels of large values

``` python
chart + chart.mark_text(align='left', dx=2).encode(text=alt.Text('sum(sum)', format='$.3~s'))
```

Notes: The `s` format string changes the values to millions as per the
standard international units convention that we discussed earlier.

We use `.3` to indicate that we want three significant digits for each
label, otherwise they would all be printed with six decimals or so,
which is hard to read.

We also specify `~`, which removes trailing zero, e.g.the top bar says
`15` instead of `15.0`.

---

## The redundant x-axis can be removed

``` python
title = alt.TitleParams(
    text='Wikipedia receives most donations on Wednesdays',
    subtitle='Values represent the total amount donated in 2020',
    anchor='start', dx=26, dy=-5)
chart = alt.Chart(donations, title=title).mark_bar().encode(
    alt.Y('week_day', sort=list(day_abbr), title=None),
    alt.X('sum(sum)', axis=None),
    color = alt.condition(alt.datum.week_day == 'Wed',
                          alt.value('coral'),
                          alt.value('steelblue')))
(chart + chart.mark_text(align='left', dx=2).encode(text=alt.Text('sum(sum)', format='$.3s'))).configure_view(strokeWidth=0)
```

<?xml version="1.0" encoding="utf-8"?>


<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="marks" width="524" height="186" viewBox="0 0 524 186"><rect width="524" height="186" fill="white"/><g fill="none" stroke-miterlimit="10" transform="translate(36,41)"><g class="mark-group role-frame root" role="graphics-object" aria-roledescription="group mark container"><g transform="translate(0,0)"><path class="background" aria-hidden="true" d="M0,0h400v140h-400Z" stroke="#ddd" stroke-width="0"/><g><g class="mark-group role-axis" role="graphics-symbol" aria-roledescription="axis" aria-label="Y-axis for a discrete scale with 7 values: Mon, Tue, Wed, Thu, Fri, Sat, Sun"><g transform="translate(0.5,0.5)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-rule role-axis-tick" pointer-events="none"><line transform="translate(0,10)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,30)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,50)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,70)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,90)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,110)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/><line transform="translate(0,130)" x2="-5" y2="0" stroke="#888" stroke-width="1" opacity="1"/></g><g class="mark-text role-axis-label" pointer-events="none"><text text-anchor="end" transform="translate(-7,12.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Mon</text><text text-anchor="end" transform="translate(-7,32.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Tue</text><text text-anchor="end" transform="translate(-7,52.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Wed</text><text text-anchor="end" transform="translate(-7,72.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Thu</text><text text-anchor="end" transform="translate(-7,92.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Fri</text><text text-anchor="end" transform="translate(-7,112.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sat</text><text text-anchor="end" transform="translate(-7,132.5)" font-family="sans-serif" font-size="10px" fill="#000" opacity="1">Sun</text></g><g class="mark-rule role-axis-domain" pointer-events="none"><line transform="translate(0,0)" x2="0" y2="140" stroke="#888" stroke-width="1" opacity="1"/></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g><g class="mark-rect role-mark layer_0_marks" role="graphics-object" aria-roledescription="rect mark container"><path aria-label="Sum of sum: 23848858.81; week_day: Thu" role="graphics-symbol" aria-roledescription="bar" d="M0,61h272.55838639999996v18h-272.55838639999996Z" fill="steelblue"/><path aria-label="Sum of sum: 12787407.98; week_day: Fri" role="graphics-symbol" aria-roledescription="bar" d="M0,81h146.14180548571426v18h-146.14180548571426Z" fill="steelblue"/><path aria-label="Sum of sum: 12061522.69; week_day: Sat" role="graphics-symbol" aria-roledescription="bar" d="M0,101h137.84597359999998v18h-137.84597359999998Z" fill="steelblue"/><path aria-label="Sum of sum: 8721644.39; week_day: Sun" role="graphics-symbol" aria-roledescription="bar" d="M0,121h99.6759358857143v18h-99.6759358857143Z" fill="steelblue"/><path aria-label="Sum of sum: 15039791.9; week_day: Mon" role="graphics-symbol" aria-roledescription="bar" d="M0,1h171.88333599999999v18h-171.88333599999999Z" fill="steelblue"/><path aria-label="Sum of sum: 19677744.17; week_day: Tue" role="graphics-symbol" aria-roledescription="bar" d="M0,21h224.8885048v18h-224.8885048Z" fill="steelblue"/><path aria-label="Sum of sum: 32459395.05; week_day: Wed" role="graphics-symbol" aria-roledescription="bar" d="M0,41h370.9645148571429v18h-370.9645148571429Z" fill="coral"/></g><g class="mark-text role-mark layer_1_marks" role="graphics-object" aria-roledescription="text mark container"><text aria-label="Sum of sum: $23.8M; week_day: Thu" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(274.55838639999996,73)" font-family="sans-serif" font-size="11px" fill="steelblue">$23.8M</text><text aria-label="Sum of sum: $12.8M; week_day: Fri" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(148.14180548571426,93)" font-family="sans-serif" font-size="11px" fill="steelblue">$12.8M</text><text aria-label="Sum of sum: $12.1M; week_day: Sat" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(139.84597359999998,113)" font-family="sans-serif" font-size="11px" fill="steelblue">$12.1M</text><text aria-label="Sum of sum: $8.72M; week_day: Sun" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(101.6759358857143,133)" font-family="sans-serif" font-size="11px" fill="steelblue">$8.72M</text><text aria-label="Sum of sum: $15.0M; week_day: Mon" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(173.88333599999999,13)" font-family="sans-serif" font-size="11px" fill="steelblue">$15.0M</text><text aria-label="Sum of sum: $19.7M; week_day: Tue" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(226.8885048,33)" font-family="sans-serif" font-size="11px" fill="steelblue">$19.7M</text><text aria-label="Sum of sum: $32.5M; week_day: Wed" role="graphics-symbol" aria-roledescription="text mark" text-anchor="start" transform="translate(372.9645148571429,53)" font-family="sans-serif" font-size="11px" fill="coral">$32.5M</text></g><g class="mark-group role-title"><g transform="translate(-31,-31)"><path class="background" aria-hidden="true" d="M0,0h0v0h0Z" pointer-events="none"/><g><g class="mark-text role-title-text" role="graphics-symbol" aria-roledescription="title" aria-label="Title text 'Wikipedia receives most donations on Wednesdays'" pointer-events="none"><text text-anchor="start" transform="translate(26,5)" font-family="sans-serif" font-size="13px" font-weight="bold" fill="#000" opacity="1">Wikipedia
receives most donations on
Wednesdays</text></g><g class="mark-text role-title-subtitle" role="graphics-symbol" aria-roledescription="subtitle" aria-label="Subtitle text 'Values represent the total amount donated in 2020'" pointer-events="none"><text text-anchor="start" transform="translate(26,20)" font-family="sans-serif" font-size="12px" fill="#000" opacity="1">Values
represent the total amount donated in
2020</text></g></g><path class="foreground" aria-hidden="true" d="" pointer-events="none" display="none"/></g></g></g><path class="foreground" aria-hidden="true" d="" display="none"/></g></g></g></svg>

Notes: We can make our chart stand out by styling it further. Here we
remove the x-axis, which is now redundant as we have included its
information directly in the text annotations.

We add a title to the plot with the take home message and explain what
the values are in the subtitle. We anchor the title to the start (left)
of the plot and use `dx` to align it with the bottom of the bars since
this often looks more visually appealing for horizontal bar chart.

We use `dy` to add additional whitespace between the subtitle and the
topmost bar and remove the grey ourline by setting the `strokeWidth` to
0.

---

## Themes can be used to change the overall styling of the chart

``` python
alt.themes.enable('dark');
((chart
 + chart
  .mark_text(align='left', dx=2)
  .encode(text=alt.Text('sum(sum)', format='$.3s')))
 .configure_view(strokeWidth=0)
 .configure_title(subtitleColor='white'))
```

Notes: To style multiple visual components of our charts in the same
command, we can use the built-in themes in Altair. Here we set the theme
to dark, which automatically changes the color of the y-axis labels and
chart title.

Unfortunately, the subtitle color does not yet change automatically, so
we need to change this manually.

We could have rewritten the entire plot from last slide and added
`subtitleColor` to `alt.TitleParams`, but here we use `configure_title`
instead.

The `configure_*` chart methods are useful when we want to make a
modification to an already existing chart without copying and pasting
all the code, but in general it is preferred to change these parameters
direclty in the main chart code instead ([you can read this section of
the docs to find out
more](https://altair-viz.github.io/user_guide/customization.html#user-guide-customization)\].

All the available themes can be shown with `alt.themes.names()`, and
currently they are
`['dark', 'default', 'fivethirtyeight', 'ggplot2', 'latimes', 'none', 'opaque', 'quartz', 'urbaninstitute', 'vox']`.

---

# Lets apply what we learned!

Notes: <br>
